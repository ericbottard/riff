== Prerequisites

a running 1.7 Kubernetes cluster with at least 4GB of memory

these instructions assume minikube for now, for example:

```
minikube start --cpus=4 --memory=4096 --disk-size=64g
```

== Build the kubernetes-model jar Enhanced with Sk8s Types
```
cd <elsewhere>
git clone https://github.com/ericbottard/kubernetes-model
git checkout sk8s
make
cd <back to the clone of this repo>
```
== Create Sk8s Custom Resource Definitions
```
kubectl apply -f config/types
```

== Build

```
eval $(minikube docker-env)
./mvnw clean package
./dockerize
```

== Create Kafka/Zookeeper

```
kubectl apply -f config/kafka
```

== Deploy

```
kubectl apply -f config
```

== Create a Handler

```
kubectl create -f samples/shell-handler.yaml
```

== Create a Topic

```
kubectl create -f samples/greetings-topic.yaml
```

== Create a Function

```
kubectl create -f samples/echo-function.yaml
```

== Publish a Message to the Topic

```
./publish greetings hello
```

== Watch Results on Minikube

```
minikube ssh
tail -f /messages/greetings.log
```

== Add a Spring Cloud Function

=== Build the JAR and Install it to Your Local Maven Repo

```
cd samples/java/greeter
./mvnw clean install
```

=== Copy the JAR to the Volume Mount Location

```
minikube ssh
sudo mkdir /functions
sudo cp /Users/[name]/.m2/repository/io/sk8s/samples/greeter/1.0.0/greeter-1.0.0.jar /functions/
```

=== Create the Handler

```
kubectl create -f samples/spring-handler.yaml
```

=== Create a New Topic

```
kubectl create -f samples/names-topic.yaml
```

=== Create the Function

```
kubectl create -f samples/greeter-function.yaml
```

=== Publish a Message

```
./publish names World
```

== Tear it all down

```
./teardown
```
